<!-- TEST 20:09 -->
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Stick Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; background:black; overflow:hidden; }
  canvas { display:block; }
</style>
</head>

<body>
<canvas id="c"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");

c.width = innerWidth;
c.height = innerHeight;

// ===== PLAYER =====
const player = {
  x: 140,
  y: 0,
  baseY: c.height - 140,
  vy: 0,
  jumping: false,
  legPhase: 0
};

const gravity = 0.7;
const jumpPower = -14;
const speed = 4;

// ===== OBSTACLES =====
let obstacles = [];

// ===== INPUT =====
addEventListener("keydown", e => e.code==="Space" && jump());
addEventListener("touchstart", jump);

function jump(){
  if(!player.jumping){
    player.vy = jumpPower;
    player.jumping = true;
  }
}

// ===== RESET =====
function reset(){
  obstacles = [];
  player.y = player.baseY;
  player.vy = 0;
  player.jumping = false;
}

// ===== SPAWN OBSTACLE =====
function spawnObstacle(){
  obstacles.push({
    x: c.width + 40,
    y: player.baseY + 30,
    r: 16
  });
}

// ===== DRAW FOG =====
function drawFog(t){
  for(let i=0;i<6;i++){
    ctx.fillStyle = "rgba(255,255,255,0.04)";
    ctx.beginPath();
    ctx.arc(
      (t*0.3 + i*220) % c.width,
      120 + i*80,
      180,
      0, Math.PI*2
    );
    ctx.fill();
  }
}

// ===== DRAW STICK =====
function drawStick(){
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;

  const swing = Math.sin(player.legPhase) * 12;

  // head
  ctx.beginPath();
  ctx.arc(player.x, player.y - 25, 12, 0, Math.PI*2);
  ctx.stroke();

  // body
  ctx.beginPath();
  ctx.moveTo(player.x, player.y - 10);
  ctx.lineTo(player.x, player.y + 30);
  ctx.stroke();

  // arms
  ctx.beginPath();
  ctx.moveTo(player.x - 12, player.y + 5);
  ctx.lineTo(player.x + 12, player.y + 5);
  ctx.stroke();

  // legs (ANIMATED)
  ctx.beginPath();
  ctx.moveTo(player.x, player.y + 30);
  ctx.lineTo(player.x - swing, player.y + 55);
  ctx.moveTo(player.x, player.y + 30);
  ctx.lineTo(player.x + swing, player.y + 55);
  ctx.stroke();
}

// ===== LOOP =====
let frame = 0;
function loop(t){
  ctx.clearRect(0,0,c.width,c.height);

  // fog background
  drawFog(t);

  // ground
  ctx.strokeStyle="#333";
  ctx.beginPath();
  ctx.moveTo(0, player.baseY + 55);
  ctx.lineTo(c.width, player.baseY + 55);
  ctx.stroke();

  // physics
  player.vy += gravity;
  player.y += player.vy;

  if(player.y >= player.baseY){
    player.y = player.baseY;
    player.vy = 0;
    player.jumping = false;
  }

  // leg animation
  if(!player.jumping) player.legPhase += 0.2;

  // obstacles
  frame++;
  if(frame % 110 === 0) spawnObstacle();

  obstacles.forEach(o=>{
    o.x -= speed;

    ctx.fillStyle = "#777";
    ctx.beginPath();
    ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
    ctx.fill();

    // collision
    const dx = player.x - o.x;
    const dy = (player.y + 30) - o.y;
    if(Math.sqrt(dx*dx + dy*dy) < o.r + 14) reset();
  });

  obstacles = obstacles.filter(o=>o.x>-50);

  drawStick();
  requestAnimationFrame(loop);
}

reset();
loop();
</script>
</body>
</html>
